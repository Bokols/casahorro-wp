/**
 * Product Card Styles (PLP)
 * casAhorro Design System - C1 Specification
 *
 * Requirements:
 * - 4:3 aspect ratio image with reserved space (no CLS)
 * - Neutral placeholder (no neon backgrounds)
 * - CLP price formatting with neutral ink color
 * - Title limited to 2-3 lines with ellipsis
 * - Link hover = underline only
 * - Focus-visible outline (3px)
 * - Affiliate disclosure below "Ver oferta" if present
 * - Stable layout (no cumulative layout shift)
 * - Palette-compliant colors only
 *
 * @package HelloElementorChild
 * @since 0.2.0
 */

/* ========================================
   PRODUCT CARD CONTAINER
   ======================================== */

.product-card {
	position: relative;
	display: flex;
	flex-direction: column;
	height: 100%;
	background-color: var(--color-surface-background, #FFFFFF);
	border: 1px solid var(--color-border-default, #E2E8F0);
	border-radius: var(--radius-md, 12px);
	overflow: hidden;
	transition: transform var(--motion-duration-fast, 180ms) var(--motion-easing-default, cubic-bezier(0.4, 0, 0.2, 1)),
	            box-shadow var(--motion-duration-fast, 180ms) var(--motion-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

.product-card:hover {
	transform: translateY(-2px);
	box-shadow: var(--shadow-elevated, 0 10px 15px -3px rgba(30, 41, 59, 0.1), 0 4px 6px -2px rgba(30, 41, 59, 0.05));
}

.product-card__inner {
	display: flex;
	flex-direction: column;
	height: 100%;
}

/* ========================================
   PRODUCT IMAGE (4:3 ASPECT RATIO)
   ======================================== */

/**
 * Reserved 4:3 aspect ratio box to prevent CLS
 * Image loads into fixed-size container
 */
.product-card__image {
	position: relative;
	width: 100%;
	aspect-ratio: 4 / 3; /* Reserve 4:3 space */
	background-color: var(--color-surface-background-alt, #F8FAFC);
	overflow: hidden;
}

.product-card__image-link {
	display: block;
	width: 100%;
	height: 100%;
	text-decoration: none;
}

.product-card__image-link:focus-visible {
	outline: var(--a11y-focus-ring-width, 3px) var(--a11y-focus-ring-style, solid) var(--a11y-focus-ring-color, #1E293B);
	outline-offset: -3px; /* Inside border to prevent overflow */
	z-index: 1;
}

.product-card__thumbnail {
	width: 100%;
	height: 100%;
	object-fit: cover; /* Fill 4:3 box */
	object-position: center;
}

/* Neutral placeholder (no neon backgrounds) */
.product-card__placeholder {
	display: flex;
	align-items: center;
	justify-content: center;
	width: 100%;
	height: 100%;
	background-color: var(--color-surface-background-alt, #F8FAFC); /* Neutral gray */
}

.product-card__placeholder svg {
	opacity: 0.5;
}

/* Sale Badge */
.product-card__badge {
	position: absolute;
	top: var(--spacing-3, 12px);
	left: var(--spacing-3, 12px);
	padding: var(--spacing-1, 4px) var(--spacing-3, 12px);
	background-color: var(--color-accent-surface-coral, #f2ddda); /* Pastel coral */
	color: var(--color-text-primary, #1E293B);
	font-size: var(--font-size-micro, 12px);
	font-weight: var(--font-weight-semibold, 600);
	border-radius: var(--radius-sm, 8px);
	text-transform: uppercase;
	letter-spacing: 0.05em;
}

.product-card__badge--sale {
	background-color: var(--color-accent-surface-coral, #f2ddda);
}

/* ========================================
   PRODUCT CONTENT
   ======================================== */

.product-card__content {
	display: flex;
	flex-direction: column;
	gap: var(--spacing-3, 12px);
	padding: var(--spacing-4, 16px);
	width: 100%;
	flex: 1; /* Fill remaining space */
}

/* ========================================
   PRODUCT TITLE (2-3 LINES MAX)
   ======================================== */

.product-card__title {
	margin: 0;
	font-size: var(--font-size-body, 16px);
	font-weight: var(--font-weight-medium, 500);
	line-height: var(--line-height-tight, 1.4);
	color: var(--color-text-primary, #1E293B);
	
	/* Limit to 2-3 lines with ellipsis */
	display: -webkit-box;
	-webkit-box-orient: vertical;
	-webkit-line-clamp: 3;
	line-clamp: 3;
	overflow: hidden;
	text-overflow: ellipsis;
	max-height: calc(var(--line-height-tight, 1.4) * 3em); /* Reserve 3 lines */
}

.product-card__title-link {
	color: inherit;
	text-decoration: none;
}

/* Link hover = underline only (C1 pattern) */
.product-card__title-link:hover {
	text-decoration: underline;
	text-decoration-thickness: 1px;
	text-underline-offset: 2px;
}

.product-card__title-link:focus-visible {
	outline: var(--a11y-focus-ring-width, 3px) var(--a11y-focus-ring-style, solid) var(--a11y-focus-ring-color, #1E293B);
	outline-offset: var(--a11y-focus-ring-offset, 2px);
	border-radius: var(--radius-xs, 4px);
}

/* ========================================
   PRODUCT PRICE (CLP + NEUTRAL INK)
   ======================================== */

.product-card__price {
	display: flex;
	align-items: baseline;
	gap: var(--spacing-2, 8px);
	flex-wrap: wrap;
	font-family: var(--font-family-base, system-ui, -apple-system, sans-serif);
}

/* Current/Regular price */
.product-card__price .price,
.product-card__price .amount,
.product-card__price .woocommerce-Price-amount {
	font-size: var(--font-size-large, 20px);
	font-weight: var(--font-weight-semibold, 600);
	color: var(--color-text-primary, #1E293B); /* Neutral ink, not saturated */
	line-height: 1;
}

/* Sale price (larger, emphasized) */
.product-card__price ins .amount,
.product-card__price ins .woocommerce-Price-amount {
	font-size: var(--font-size-xlarge, 24px);
	font-weight: var(--font-weight-bold, 700);
	color: var(--color-text-primary, #1E293B);
	text-decoration: none; /* Remove default <ins> underline */
}

/* Regular price (strikethrough when on sale) */
.product-card__price del .amount,
.product-card__price del .woocommerce-Price-amount {
	font-size: var(--font-size-small, 14px);
	font-weight: var(--font-weight-medium, 500);
	color: var(--color-text-secondary, #475569);
	text-decoration: line-through;
	opacity: 0.75;
}

/* Remove WooCommerce default <ins> and <del> styling */
.product-card__price ins,
.product-card__price del {
	background: none;
	text-decoration: none;
}

.product-card__price ins {
	text-decoration: none;
}

.product-card__price del {
	text-decoration: line-through;
}

/* ========================================
   PRODUCT ACTIONS (BUTTONS)
   ======================================== */

.product-card__actions {
	margin-top: auto; /* Push to bottom */
	display: flex;
	flex-direction: column;
	gap: var(--spacing-2, 8px);
}

.product-card__button {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	gap: var(--spacing-2, 8px);
	min-height: var(--a11y-min-tap-target, 44px);
	padding: var(--spacing-2, 8px) var(--spacing-4, 16px);
	background-color: var(--color-text-primary, #1E293B);
	color: var(--color-surface-background, #FFFFFF);
	border: none;
	border-radius: var(--radius-sm, 8px);
	font-size: var(--font-size-small, 14px);
	font-weight: var(--font-weight-semibold, 600);
	text-decoration: none;
	cursor: pointer;
	transition: opacity var(--motion-duration-fast, 180ms) var(--motion-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

/* Button hover = opacity 0.92 (C1 pattern) */
.product-card__button:hover {
	opacity: 0.92;
}

.product-card__button:focus-visible {
	outline: var(--a11y-focus-ring-width, 3px) var(--a11y-focus-ring-style, solid) var(--a11y-focus-ring-color, #1E293B);
	outline-offset: var(--a11y-focus-ring-offset, 2px);
}

.product-card__button svg {
	width: 16px;
	height: 16px;
	flex-shrink: 0;
}

/* External link button (affiliate) */
.product-card__button--external {
	background-color: var(--color-text-primary, #1E293B);
	color: var(--color-surface-background, #FFFFFF);
}

/* ========================================
   AFFILIATE DISCLOSURE
   ======================================== */

/**
 * Appears below "Ver oferta" button for affiliate products
 * Small text with link to transparency page
 */
.product-card__disclosure {
	margin: 0;
	font-size: var(--font-size-micro, 12px);
	line-height: var(--line-height-normal, 1.6);
	color: var(--color-text-secondary, #475569);
	text-align: center;
}

.product-card__disclosure small {
	display: inline;
}

.product-card__disclosure-link {
	color: var(--color-text-link, #1E293B);
	text-decoration: underline;
	text-decoration-thickness: 1px;
	text-underline-offset: 2px;
}

.product-card__disclosure-link:hover {
	color: var(--color-text-link-hover, #475569);
}

.product-card__disclosure-link:focus-visible {
	outline: var(--a11y-focus-ring-width, 3px) var(--a11y-focus-ring-style, solid) var(--a11y-focus-ring-color, #1E293B);
	outline-offset: var(--a11y-focus-ring-offset, 2px);
	border-radius: var(--radius-xs, 4px);
}

/* ========================================
   WOOCOMMERCE DEFAULT OVERRIDES
   ======================================== */

/**
 * Override WooCommerce default product loop styles
 * to match C1 design system
 */

/* Remove WooCommerce default product styling */
.woocommerce ul.products li.product,
.woocommerce-page ul.products li.product {
	background: none;
	border: none;
	padding: 0;
	margin: 0;
	text-align: left;
}

/* ========================================
   FULL-WIDTH CONTENT NORMALIZATION
   ======================================== */

/**
 * Ensure card content fills the grid column track
 * Removes width constraints from Elementor/WooCommerce wrappers
 * that cause narrow content inside wide columns
 * Scoped to ul.products li.product to avoid affecting other pages
 */

/* Grid item and card root - allow flex/grid shrink */
ul.products li.product {
	min-width: 0; /* Allow grid item to shrink below content size */
}

ul.products li.product .product-card {
	min-width: 0; /* Allow card to shrink in flex/grid */
	width: 100%; /* Fill grid track */
}

/* Content wrapper fills card width */
ul.products li.product .product-card__content {
	width: 100%;
	min-width: 0;
}

/* Remove max-width caps from Elementor wrappers (PLP only) */
ul.products li.product .elementor-widget-wrap,
ul.products li.product .elementor-widget-container {
	max-width: none; /* Remove Elementor default max-width */
	width: 100%;
}

/* Remove WooCommerce link wrapper constraints */
ul.products li.product .woocommerce-loop-product__link {
	display: contents; /* Remove wrapper, preserve children */
	max-width: none;
}

/* Ensure short description doesn't cap width */
ul.products li.product .woocommerce-product-details__short-description {
	max-width: none;
	width: 100%;
}

/* Remove WooCommerce default title styling */
.woocommerce ul.products li.product .woocommerce-loop-product__title {
	all: unset;
	display: block;
}

/* Remove WooCommerce default price styling */
.woocommerce ul.products li.product .price {
	color: inherit;
	font-size: inherit;
	font-weight: inherit;
}

/* Remove WooCommerce default button styling */
.woocommerce ul.products li.product .button {
	all: unset;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	gap: var(--spacing-2, 8px);
	min-height: var(--a11y-min-tap-target, 44px);
	padding: var(--spacing-2, 8px) var(--spacing-4, 16px);
	background-color: var(--color-text-primary, #1E293B);
	color: var(--color-surface-background, #FFFFFF);
	border-radius: var(--radius-sm, 8px);
	font-size: var(--font-size-small, 14px);
	font-weight: var(--font-weight-semibold, 600);
	text-decoration: none;
	cursor: pointer;
	transition: opacity var(--motion-duration-fast, 180ms) var(--motion-easing-default, cubic-bezier(0.4, 0, 0.2, 1));
}

.woocommerce ul.products li.product .button:hover {
	opacity: 0.92;
}

/* ========================================
   MOBILE OPTIMIZATIONS
   ======================================== */

@media (max-width: 768px) {
	.product-card__content {
		padding: var(--spacing-3, 12px);
		gap: var(--spacing-2, 8px);
	}

	.product-card__title {
		font-size: var(--font-size-small, 14px);
		-webkit-line-clamp: 2; /* 2 lines on mobile */
		line-clamp: 2;
		max-height: calc(var(--line-height-tight, 1.4) * 2em);
	}

	.product-card__price .price,
	.product-card__price .amount,
	.product-card__price .woocommerce-Price-amount {
		font-size: var(--font-size-body, 16px);
	}

	.product-card__price ins .amount,
	.product-card__price ins .woocommerce-Price-amount {
		font-size: var(--font-size-large, 20px);
	}

	.product-card__badge {
		top: var(--spacing-2, 8px);
		left: var(--spacing-2, 8px);
		padding: var(--spacing-1, 4px) var(--spacing-2, 8px);
		font-size: var(--font-size-micro, 12px);
	}
}

/* ========================================
   ACCESSIBILITY - REDUCED MOTION
   ======================================== */

@media (prefers-reduced-motion: reduce) {
	.product-card,
	.product-card__button {
		transition: none;
	}

	.product-card:hover {
		transform: none;
	}
}

/* ========================================
   HIGH CONTRAST MODE
   ======================================== */

@media (forced-colors: active) {
	.product-card {
		border: 2px solid ButtonBorder;
	}

	.product-card__button {
		border: 2px solid ButtonBorder;
	}

	.product-card__badge {
		border: 1px solid CanvasText;
	}
}
